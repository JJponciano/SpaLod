<!DOCTYPE html>
<!--
Copyright (C) 2022 Claire Ponciano <claire@prudhomme.info>.

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301  USA
-->
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>SPALOD</title>
    <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600"
    />
    <!-- https://fonts.google.com/specimen/Open+Sans -->
    <link rel="stylesheet" href="css/all.min.css"/>
    <!-- https://fontawesome.com/ -->
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <!-- https://getbootstrap.com/ -->
    <link rel="stylesheet" href="css/tooplate-style.css"/>

    <link rel="stylesheet" href="css/boundingBox.css"/>
    <link rel="stylesheet" href="css/mousseCoordinates.css"/>

</head>

<body onload="onLoad()">
<!-- page header -->
<div class="container" id="home">
    <div class="col-12 text-center">
        <div class="tm-page-header">
            <i class="fas fa-4x fa-chart-bar mr-4"></i>
            <h1 class="d-inline-block text-uppercase">SPALOD</h1>
        </div>
    </div>
</div>
<!-- navbar -->
<div class="tm-nav-section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="navbar navbar-expand-md navbar-light">
                    <button
                            class="navbar-toggler"
                            type="button"
                            data-toggle="collapse"
                            data-target="#tmMainNav"
                            aria-controls="tmMainNav"
                            aria-expanded="false"
                            aria-label="Toggle navigation"
                    >
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="tmMainNav">
                        <ul class="navbar-nav mx-auto tm-navbar-nav">
                            <li class="nav-item active">
                                <a class="nav-link" href="/home">Home</a
                                >
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/lod">LOD <span class="sr-only">(current)</span></a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/uplift">GeoJSON</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/sparqlend">SPARQL</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/assessment">Assessment</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/enrichment">Enrichment</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link external" href="">References</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</div>

<!-- Video Banner -->
<section class="tm-banner-section" id="tmVideoSection">
    <div class="container tm-banner-text-container">
        <div class="row">
            <div class="col-12">
                <header>
                    <h2 class="tm-banner-title">SPALOD</h2>
                    <p class="mx-auto tm-banner-subtitle">
                        Spatial data management with semantic web technology and Linked Open Data (LOD)
                    </p>
                </header>
            </div>
        </div>
    </div>

    <!-- Video -->
    <video id="hero-vid" autoplay="" loop="" muted>
        <source src="videos/city-night-blur-01.mp4" type="video/mp4"/>
        Your browser does not support the video tag.
    </video>
</section>

<!-- Banner-->
<div class="container" id="lod">
    <div class="row">
        <div class="col-12">
            <div class="tm-parallax">
                <header class="tm-parallax-header">
                    <h2 class="">Assessment</h2>
                </header>
            </div>
        </div>
    </div>
    <!-- Content-->
    <div class="container tm-features-section" id="features2">

        <div class="row tm-features-row">
            <section class="col-md-6 col-sm-12 tm-feature-block">
                <header class="tm-feature-header">
                    <i class="fas fa-5x fa-anchor tm-feature-icon"></i>
                    <h3 class="tm-feature-h">Dataset</h3>
                </header>
                    <div th:if="${not #lists.isEmpty(individuals)}">

                        <form th:action="@{/select}" th:object="${dataindiv}" method="post"
                              enctype="multipart/form-data">

                            <select th:field="*{name}">
                                <option th:each="md: ${individuals}" th:value="${md}" th:text="${md}"></option>
                            </select>

                            <input type="submit" value="Select"/>
                        </form>
                    </div>
                <div class="rate">
                    <input type="radio" id="star5" name="rate" value="5" />
                    <label for="star5" title="text">5 stars</label>
                    <input type="radio" id="star4" name="rate" value="4" />
                    <label for="star4" title="text">4 stars</label>
                    <input type="radio" id="star3" name="rate" value="3" />
                    <label for="star3" title="text">3 stars</label>
                    <input type="radio" id="star2" name="rate" value="2" />
                    <label for="star2" title="text">2 stars</label>
                    <input type="radio" id="star1" name="rate" value="1" />
                    <label for="star1" title="text">1 star</label>
                </div>
            </section>

            <section>
                <header class="tm-feature-header">
                    <i class="fas fa-5x fa-atom tm-feature-icon"></i>
                    <h3 class="tm-feature-h">Map</h3>
                </header>
                <!--Map -->
                <div id=map style="position : relative; width: 1200px; height: 800px; margin-bottom: 20px;">
                    <!-- Leaflet script and stylesheet -->
                    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
                            integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
                            crossorigin=""></script>
                    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
                          integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
                          crossorigin=""/>
                    <link href="../static/css/asideBox.css" type="text/css">
                    <link href="../static/css/main.css" type="text/css"/>
                    <link href="../static/css/testSPARQL.css" type="text/css">
                    <link href="../static/css/testSPARQL.css" type="text/css"/>
                    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>
                    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-minimap/3.6.1/Control.MiniMap.min.js"
                            integrity="sha512-WL3nAJlWFKoDShduxQRyY3wkBnQsINXdIfWIW48ZaPgYz1wYNnxIwFMMgigzSgjNBC2WWZ8Y8/sSyUU6abuF0g=="
                            crossorigin=""
                            referrerpolicy="no-referrer"></script>

                    <!-- Retreving data from the request -->
                    <script th:inline="javascript">
                    var dataArray = /*[[${MDlist}]]*/ 'default';
                    // Function used to retrieve size of the data array
                    // Data is stored as followed :
                    // data = [ itemIndex, itemLabel, latitude, longitude]
                    Object.size = function (obj) {
                        var size = 0,
                                key;
                        for (key in obj) {
                            if (obj.hasOwnProperty(key))
                                size++;
                        }
                        return size;
                    };
                    var sizeOfArray = Object.size(dataArray);


                    </script>
                    <script>
                            // Creation of one layer of points
                            var query = new L.layerGroup();

                            //custom  icon class
                            var MarkerIcon = L.Icon.extend({
                            options : {
                                iconSize:[20, 20],
                                shadowSize:[0, 0],
                                iconAnchor: [10, 10],
                                popupAnchor: [0, -10]
                            }
                            });

                            //path to where the files are hosted
                            //var path = 'https://raw.githubusercontent.com/JJponciano/SpaLod/main/src/main/resources/static/pictures/signaturen/';
                            var path = '../pictures/signaturen/'
                            // Loop to add every point of the results to the map
                            for (let i = 0; i < sizeOfArray; i++) {
                                 L.marker(
                                      [dataArray[i][2], dataArray[i][3]],
                                      { icon: new MarkerIcon({iconUrl: path + dataArray[i][0] +'.png'}) }
                                 ).bindPopup(dataArray[i][2]+","+dataArray[i][3]+" "+dataArray[i][1]).addTo(query);
                            }
                            var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
                                    'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                                mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

                            var rUrl = 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png';

                            var topplusUrl = 'http://sgx.geodatenzentrum.de/wms_topplus_web_open';
                            var topplusAttr = '&copy Bundesamt für Kartographie und Geodäsie 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf">Datenquellen</a>';

                            //var verUrl = 'https://sgx.geodatenzentrum.de/wms_vg250';
                            //var verAttr = '&copy Bundesamt für Kartographie und Geodäsie 2017, <a href = "https://sg.geodatenzentrum.de/web_public/gdz/dokumentation/deu/vg250_01-01.pdf"</a>';

                            // Creation of two layers : grayscale, and streets map
                            // It is also possible to add a satellite map, landform map, ..
                            var grayscale = L.tileLayer(mbUrl, {id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr}),
                                streets = L.tileLayer(mbUrl, {id: 'mapbox/streets-v11', tileSize: 512, zoomOffset: -1, attribution: mbAttr});
                                relief = L.tileLayer(rUrl, {maxZoom: 17, attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'});
                                topplus = L.tileLayer.wms(topplusUrl, {layers: 'web', format: 'image/png',transparent: true, attribution: topplusAttr});
                                //verwa = L.tileLayer.wms(verUrl, {layers: 'Kreis', format: 'image/png',transparent: true, attribution: topplusAttr});
                                mini_grayscale = new L.TileLayer(mbUrl, {id: 'mapbox/light-v9', minZoom: 0, maxZoom: 13, attribution: mbAttr});
                                mini_streets = new L.TileLayer(mbUrl, {id: 'mapbox/streets-v11', minZoom: 0, maxZoom: 13, attribution: mbAttr});
                                mini_relief = new L.TileLayer(rUrl, {minZoom: 0, maxZoom: 13, attribution: mbAttr});
                                mini_topplus = new L.tileLayer.wms(topplusUrl, {layers: 'web', format: 'image/png',transparent: true, attribution: topplusAttr});


                            // Definition of the map, and setup of details : coordinates of the center, zoom level and layers that appear on loading
                            var map = L.map('map', {
                                center: [49.99, 8.24],
                                zoom: 6,
                                minZoom: 2,
                                fullscreenControl: true,
                                layers: [streets, query]
                            });

                            // Definition of layers
                            var baseLayers = {
                                "Grayscale": grayscale,
                                "Streets": streets,
                                "Relief" : relief,
                                "Topplus" : topplus
                            };

                            // Definition of point layers
                            var overlays = {
                                "Query": query,
                            };

                            // Add layers and points layers to the map
                            var layerControl = L.control.layers(baseLayers, overlays).addTo(map);
                            var testBoundingBox = false; // Check is bounding box was open

                    </script>
                </div>
            </section>
            </section>

            <section class="col-md-6 col-sm-12 tm-feature-block">
                <header class="tm-feature-header">
                    <i class="fas fa-5x fa-anchor tm-feature-icon"></i>
                    <h3 class="tm-feature-h">Actions</h3>
                </header>
                <p>
                    <a class="button" th:href="${ontPath}">Download RDF file</a>

                <!--Directly Enrich the KB-->
                <form action="#" th:action="@{/lodenrich}"method="post">
                    <input type="submit" value="Enrich the Knowledge based"/>
                </form>

                </p>
            </section>
            <!--INFORMATION SECTION-->
            <section class="col-md-6 col-sm-12 tm-feature-block">
                <header class="tm-feature-header">
                    <i class="fas fa-5x fa-atom tm-feature-icon"></i>
                    <h3 class="tm-feature-h">Information</h3>
                </header>
                <p th:if="${message}" th:text="${message}"/>

                <p th:if="${file}">
                    <a class="button" th:href="${file}">Download file</a>
                </p>
            </section>


            <section class="col-md-6 col-sm-12 tm-feature-block">
                <header class="tm-feature-header">
                    <i class="fas fa-5x fa-atom tm-feature-icon"></i>
                    <h3 class="tm-feature-h">Results</h3>
                </header>
                <!-- Displaying the table of results -->
                <div th:if="${MDlist}" class="tableContentSPARQL">
                    <div><span id="nbOfResults" style="width: 150px; height: 10px"> 0 result(s).</span>

                        <script type="text/javascript">
                            document.getElementById("nbOfResults").innerHTML = sizeOfArray.toString().concat(" result(s).");

                        </script>
                        <table border="1" style="width: 700px; margin: 0 auto;">
                            <thead>
                            <!-- Definition of the 5 columns -->
                            <tr>
                                <th th:colspan="${#lists.size(cl)}" style="text-align: center; font-size: 1.2em;">Results of the query</th>
                            </tr>
                            <td style="text-align: center;"  th:each="name: ${cl}">
                                <span th:text="${name}"></span>
                            </td>
                            </thead>
                            <tbody>
                            <!-- Filling the 5 columns with the results from WikiData-->
                            <tr th:each="md: ${MDlist}">
                                <td  th:each="m: ${md}" style="width: 170px;"><span th:text="${m}"></span></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>



        </div>
    </div>

</div>


<footer class="container tm-footer">
    <div class="row tm-footer-row">
        <p class="col-md-10 col-sm-12 mb-0">
            <!--            Copyright &copy; 2022 Claire Ponciano:-->
            <a rel="nofollow" href="https://i3mainz.hs-mainz.de/" class="tm-footer-link">i3mainz</a>
        </p>
        <div class="col-md-2 col-sm-12 scrolltop">
            <div class="scroll icon"><i class="fa fa-4x fa-angle-up"></i></div>
        </div>
    </div>
</footer>

<script src="js/lod.js"></script>
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery.singlePageNav.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/template.js"></script>
<script src="js/boundingBox.js"/></script>
<script src="js/moussePosition.js"/></script>
<script src="js/miniMap.js"></script>


</body>
</html>
